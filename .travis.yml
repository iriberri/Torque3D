matrix:
  include:
  - os: linux
    dist: trusty
    sudo: required
    services: docker
    env: OS_ID="ubuntu-latest-lts" ADDITIONAL_CMAKE_ARGS="-DTORQUE_PHYSICS_BULLET=on -DTORQUE_TESTING=on" DEPLOYABLE_CONF=true
  - os: osx
    eosx_image: xcode8.3
    env: ADDITIONAL_CMAKE_ARGS="-DTORQUE_TESTING=on -DTORQUE_PHYSICS_BULLET=on" DEPLOYABLE_CONF=true

language: cpp
compiler: gcc

install:
- source ./Tools/travis/install.sh

script:
- |
  if [[ $TRAVIS_OS_NAME = linux ]];then
  docker_exec ./Tools/travis/script.sh
  else
  ./Tools/travis/script.sh
  fi

before_deploy:
- source ./Tools/travis/beforeDeploy.sh

deploy:
  provider: releases
  api_key:
    secure: Gl840+EF6vmleBBIV9QiI/y5rbmE8Bb6rF7r/JY0HIVRzSdXMUH1VWbBueYKejOELtU+4WapBUb3D4V7ZW0kDiaNkRnTBix+QdBK3yyR+4676d2KpKYIK4DuOt7Xb8AFYFcHXMY+DbOJQbHj1+WVbKrb+hEjFwxC3YISn852FGzAJ1g8f6GnoKtyfX5skIrd8cs5YpWcYLUrsa5s0Dc3Yg+vI0MMuImFwzLiXWaeWyfwB9YUPycy6Mq3NXsZCXRaCuBvdQqFVZFsZCqd25KXJCtu0osKT4DWwNDCG4E3yeX7SIfsq6E5ujD5OU0qX+FOtZ2P8ZLqh9wv1q+B/Bi3s74lNcrfEAzoeljT05BFdIqL5Rg3JNvqWus2for7YgmWVcHr5cBf1U0DT0t/9rnCTrOBBdn4fhw3NPJuGezAaKEYyL5iRlauM8EH9pHUEuLYKigZ4CH+9efqYAqXv8gI5kmyvnng+i2mAtm+TAueFyZtNqeobWIuGKTCextGmIgjRryJ+lzuizr/uy809O1W8DW4cExHRbcQUN696J0VU5uEabzqobc96jzHtGSPi9kc7o4ZX0AVgbYvRYC5Bcq4Idpnx0Ml+lOId9x5nt4VrkTCtf1KCXg2VfhURqT+D/VHcv5BjeJWdvWA7MK/hy5g3jEanlPFQ0aoDPnaBuWT1evA
  file: "My Projects/Torque3D/game/${BUNDLE_NAME}"
  skip_cleanup: true
  overwrite: true
  on:
    all_branches: true
    condition: $DEPLOY_CONDITION
